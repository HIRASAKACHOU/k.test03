import pandas as pd

# 读取现有坐标数据
existing_df = pd.read_csv('city_latlon_complete.csv')

# 47个都道府県的代表坐标（府厅/県庁所在地）
prefecture_coordinates = [
    {'地区コード': 1000, '都道府県コード': 1, '都道府県名': '北海道', '地区名称': '北海道', '緯度': 43.0642, '経度': 141.3469},
    {'地区コード': 2000, '都道府県コード': 2, '都道府県名': '青森県', '地区名称': '青森県', '緯度': 40.8244, '経度': 140.7400},
    {'地区コード': 3000, '都道府県コード': 3, '都道府県名': '岩手県', '地区名称': '岩手県', '緯度': 39.7036, '経度': 141.1527},
    {'地区コード': 4000, '都道府県コード': 4, '都道府県名': '宮城県', '地区名称': '宮城県', '緯度': 38.2682, '経度': 140.8694},
    {'地区コード': 5000, '都道府県コード': 5, '都道府県名': '秋田県', '地区名称': '秋田県', '緯度': 39.7186, '経度': 140.1024},
    {'地区コード': 6000, '都道府県コード': 6, '都道府県名': '山形県', '地区名称': '山形県', '緯度': 38.2404, '経度': 140.3633},
    {'地区コード': 7000, '都道府県コード': 7, '都道府県名': '福島県', '地区名称': '福島県', '緯度': 37.7503, '経度': 140.4676},
    {'地区コード': 8000, '都道府県コード': 8, '都道府県名': '茨城県', '地区名称': '茨城県', '緯度': 36.3418, '経度': 140.4467},
    {'地区コード': 9000, '都道府県コード': 9, '都道府県名': '栃木県', '地区名称': '栃木県', '緯度': 36.5656, '経度': 139.8836},
    {'地区コード': 10000, '都道府県コード': 10, '都道府県名': '群馬県', '地区名称': '群馬県', '緯度': 36.3911, '経度': 139.0608},
    {'地区コード': 11000, '都道府県コード': 11, '都道府県名': '埼玉県', '地区名称': '埼玉県', '緯度': 35.8617, '経度': 139.6455},
    {'地区コード': 12000, '都道府県コード': 12, '都道府県名': '千葉県', '地区名称': '千葉県', '緯度': 35.6047, '経度': 140.1233},
    {'地区コード': 13000, '都道府県コード': 13, '都道府県名': '東京都', '地区名称': '東京都', '緯度': 35.6895, '経度': 139.6917},
    {'地区コード': 14000, '都道府県コード': 14, '都道府県名': '神奈川県', '地区名称': '神奈川県', '緯度': 35.4478, '経度': 139.6425},
    {'地区コード': 15000, '都道府県コード': 15, '都道府県名': '新潟県', '地区名称': '新潟県', '緯度': 37.9022, '経度': 139.0233},
    {'地区コード': 16000, '都道府県コード': 16, '都道府県名': '富山県', '地区名称': '富山県', '緯度': 36.6953, '経度': 137.2113},
    {'地区コード': 17000, '都道府県コード': 17, '都道府県名': '石川県', '地区名称': '石川県', '緯度': 36.5946, '経度': 136.6256},
    {'地区コード': 18000, '都道府県コード': 18, '都道府県名': '福井県', '地区名称': '福井県', '緯度': 36.0652, '経度': 136.2217},
    {'地区コード': 19000, '都道府県コード': 19, '都道府県名': '山梨県', '地区名称': '山梨県', '緯度': 35.6642, '経度': 138.5683},
    {'地区コード': 20000, '都道府県コード': 20, '都道府県名': '長野県', '地区名称': '長野県', '緯度': 36.6513, '経度': 138.1810},
    {'地区コード': 21000, '都道府県コード': 21, '都道府県名': '岐阜県', '地区名称': '岐阜県', '緯度': 35.3912, '経度': 136.7222},
    {'地区コード': 22000, '都道府県コード': 22, '都道府県名': '静岡県', '地区名称': '静岡県', '緯度': 34.9769, '経度': 138.3831},
    {'地区コード': 23000, '都道府県コード': 23, '都道府県名': '愛知県', '地区名称': '愛知県', '緯度': 35.1802, '経度': 136.9066},
    {'地区コード': 24000, '都道府県コード': 24, '都道府県名': '三重県', '地区名称': '三重県', '緯度': 34.7303, '経度': 136.5086},
    {'地区コード': 25000, '都道府県コード': 25, '都道府県名': '滋賀県', '地区名称': '滋賀県', '緯度': 35.0045, '経度': 135.8686},
    {'地区コード': 26000, '都道府県コード': 26, '都道府県名': '京都府', '地区名称': '京都府', '緯度': 35.0116, '経度': 135.7681},
    {'地区コード': 27000, '都道府県コード': 27, '都道府県名': '大阪府', '地区名称': '大阪府', '緯度': 34.6937, '経度': 135.5023},
    {'地区コード': 28000, '都道府県コード': 28, '都道府県名': '兵庫県', '地区名称': '兵庫県', '緯度': 34.6901, '経度': 135.1955},
    {'地区コード': 29000, '都道府県コード': 29, '都道府県名': '奈良県', '地区名称': '奈良県', '緯度': 34.6851, '経度': 135.8050},
    {'地区コード': 30000, '都道府県コード': 30, '都道府県名': '和歌山県', '地区名称': '和歌山県', '緯度': 34.2261, '経度': 135.1675},
    {'地区コード': 31000, '都道府県コード': 31, '都道府県名': '鳥取県', '地区名称': '鳥取県', '緯度': 35.5014, '経度': 134.2381},
    {'地区コード': 32000, '都道府県コード': 32, '都道府県名': '島根県', '地区名称': '島根県', '緯度': 35.4722, '経度': 133.0506},
    {'地区コード': 33000, '都道府県コード': 33, '都道府県名': '岡山県', '地区名称': '岡山県', '緯度': 34.6617, '経度': 133.9350},
    {'地区コード': 34000, '都道府県コード': 34, '都道府県名': '広島県', '地区名称': '広島県', '緯度': 34.3853, '経度': 132.4553},
    {'地区コード': 35000, '都道府県コード': 35, '都道府県名': '山口県', '地区名称': '山口県', '緯度': 34.1861, '経度': 131.4706},
    {'地区コード': 36000, '都道府県コード': 36, '都道府県名': '徳島県', '地区名称': '徳島県', '緯度': 34.0658, '経度': 134.5594},
    {'地区コード': 37000, '都道府県コード': 37, '都道府県名': '香川県', '地区名称': '香川県', '緯度': 34.3400, '経度': 134.0433},
    {'地区コード': 38000, '都道府県コード': 38, '都道府県名': '愛媛県', '地区名称': '愛媛県', '緯度': 33.8416, '経度': 132.7657},
    {'地区コード': 39000, '都道府県コード': 39, '都道府県名': '高知県', '地区名称': '高知県', '緯度': 33.5597, '経度': 133.5311},
    {'地区コード': 40000, '都道府県コード': 40, '都道府県名': '福岡県', '地区名称': '福岡県', '緯度': 33.5904, '経度': 130.4017},
    {'地区コード': 41000, '都道府県コード': 41, '都道府県名': '佐賀県', '地区名称': '佐賀県', '緯度': 33.2494, '経度': 130.2989},
    {'地区コード': 42000, '都道府県コード': 42, '都道府県名': '長崎県', '地区名称': '長崎県', '緯度': 32.7447, '経度': 129.8736},
    {'地区コード': 43000, '都道府県コード': 43, '都道府県名': '熊本県', '地区名称': '熊本県', '緯度': 32.7898, '経度': 130.7417},
    {'地区コード': 44000, '都道府県コード': 44, '都道府県名': '大分県', '地区名称': '大分県', '緯度': 33.2382, '経度': 131.6126},
    {'地区コード': 45000, '都道府県コード': 45, '都道府県名': '宮崎県', '地区名称': '宮崎県', '緯度': 31.9111, '経度': 131.4239},
    {'地区コード': 46000, '都道府県コード': 46, '都道府県名': '鹿児島県', '地区名称': '鹿児島県', '緯度': 31.5602, '経度': 130.5581},
    {'地区コード': 47000, '都道府県コード': 47, '都道府県名': '沖縄県', '地区名称': '沖縄県', '緯度': 26.2124, '経度': 127.6809},
]

pref_df = pd.DataFrame(prefecture_coordinates)

# 删除现有文件中的都道府県级别坐标（xx000）
existing_filtered = existing_df[existing_df['地区コード'] % 1000 != 0].copy()

# 合并
combined_df = pd.concat([existing_filtered, pref_df], ignore_index=True)
combined_df = combined_df.sort_values('地区コード').reset_index(drop=True)

print(f"原有地区数（不包括都道府県级）: {len(existing_filtered)}")
print(f"都道府県级坐标: {len(pref_df)}")
print(f"合计: {len(combined_df)}")

# 保存
combined_df.to_csv('city_latlon_complete.csv', index=False, encoding='utf-8')
print("\n✓ city_latlon_complete.csv を更新しました")

# 验证
print(f"\n都道府県数: {combined_df['都道府県名'].nunique()}")
print(f"都道府県级别坐标数: {len(combined_df[combined_df['地区コード'] % 1000 == 0])}")
